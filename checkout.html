<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FitZy – Good Food-Good Mood</title>
  <link rel="stylesheet" href="style.css">
  <!-- FontAwesome CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>

<!-- Header -->
<header>
  <div class="logo">
    <img src="icons/my.jpg" alt="FitZy Logo">
    FitZy
  </div>

  <div class="menu-toggle" id="menu-toggle">☰</div>

  <nav id="nav-menu">
    <ul>
      <li><a href="index.html">Trang chủ</a></li>
     <li><a href="indexthucdon.html">Thực đơn</a></li>
      <li><a href="menu.html">Giới thiệu</a></li>
      <li><a href="#contact">Tin tức</a></li>
    </ul>
  </nav>

  <!-- Icon giỏ hàng -->
  <div class="cart-icon" id="cart-btn">
    <img src="icons/giohang.png" alt="Cart">
    <span class="cart-count" id="cart-count">0</span>
  </div>
</header>

<!-- Thanh trượt giỏ hàng -->
<div class="cart-sidebar" id="cart-sidebar">
  <div class="cart-header">
    <h2>Giỏ hàng</h2>
    <span class="close-cart" id="close-cart">&times;</span>
  </div>
  <div class="cart-items" id="cart-items"></div>
  <div class="cart-footer">
    <p>Tổng tiền: <span id="cart-total">0₫</span></p>
   <button id="checkout-btn" class="checkout-btn">Thanh toán</button>
  </div>
</div>

<!-- Overlay làm mờ nền -->
<div class="cart-overlay" id="cart-overlay"></div>

<!-- tong sanr pham-->
<main class="checkout-page">
  <h1>Thanh toán</h1>
  <div class="checkout-container">
    <table id="checkout-table">
      <thead>
        <tr>
          <th>Hình</th>
          <th>Sản phẩm</th>
          <th>Giá</th>
          <th>Số lượng</th>
          <th>Thành tiền</th>
        </tr>
      </thead>
      <tbody>
        <!-- JS sẽ chèn sản phẩm vào đây -->
      </tbody>
    </table>
    <div class="total">Tổng: <span id="checkout-total">0₫</span></div>
    <div class="customer-info">
  <h2>Thông tin khách hàng</h2>
  <form id="customer-form">
    <label for="name">Họ và tên:</label>
    <input type="text" id="name" name="name" placeholder="Nhập họ và tên" required>

    <label for="address">Địa chỉ:</label>
    <input type="text" id="address" name="address" placeholder="Nhập địa chỉ" required>

    <label for="email">Email:</label>
    <input type="email" id="email" name="email" placeholder="Nhập email" required>

    <label for="phone">Số điện thoại:</label>
    <input type="tel" id="phone" name="phone" placeholder="Nhập số điện thoại" required pattern="[0-9]{9,11}">

    <label for="note">Ghi chú (tùy chọn):</label>
    <textarea id="note" name="note" placeholder="Nhập ghi chú" rows="3"></textarea>
  </form>
</div>
<!-- Lựa chọn hình thức thanh toán -->
    <div class="payment-method" id="payment-method" style="display:none;">
      <h3>Chọn hình thức thanh toán</h3>
      <button id="cash-btn" class="method-btn">Tiền mặt</button>
      <button id="bank-btn" class="method-btn">Chuyển khoản</button>
    </div>

    <!-- QR code -->
   <!-- QR code -->
<div class="qr-payment" id="qr-payment" style="display:none;">
  <h3>Quét QR để thanh toán</h3>
  <div id="qrcode"></div>
  <p id="qr-info">Quét để thanh toán đúng số tiền</p>
  <button id="confirm-payment-btn" class="pay-btn">Đã thanh toán</button>
</div>

    <button class="pay-btn" id="pay-btn">Thanh toán</button>
  </div>
</main>


<script>
const cart = JSON.parse(localStorage.getItem("cart")) || [];
const tbody = document.querySelector("#checkout-table tbody");
const totalEl = document.getElementById("checkout-total");
let total = 0;

// 1️⃣ Chèn sản phẩm vào bảng
cart.forEach(item => {
  const tr = document.createElement("tr");
  const subtotal = item.price * item.quantity;
  total += subtotal;
  tr.innerHTML = `
    <td><img src="${item.image}" alt="${item.name}"></td>
    <td>${item.name}</td>
    <td>${item.price.toLocaleString()}₫</td>
    <td>${item.quantity}</td>
    <td>${subtotal.toLocaleString()}₫</td>
  `;
  tbody.appendChild(tr);
});
totalEl.textContent = total.toLocaleString() + "₫";

// 2️⃣ Lấy các phần tử thanh toán
const payBtn = document.getElementById("pay-btn");
const paymentMethodDiv = document.getElementById("payment-method");
const cashBtn = document.getElementById("cash-btn");
const bankBtn = document.getElementById("bank-btn");
const qrContainer = document.getElementById("qr-payment");

// 4️⃣ Nhấn nút Thanh toán
payBtn.addEventListener("click", () => {
  if (cart.length === 0) {
    alert("Giỏ hàng trống!");
    return;
  }

  // Lấy dữ liệu từ form
  const name = document.getElementById("name").value.trim();
  const address = document.getElementById("address").value.trim();
  const email = document.getElementById("email").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const note = document.getElementById("note").value.trim();

  if (!name || !address || !email || !phone) {
    alert("Vui lòng điền đầy đủ thông tin bắt buộc!");
    return;
  }

  // 5️⃣ Hiện lựa chọn hình thức thanh toán
  paymentMethodDiv.style.display = "block";
  payBtn.style.display = "none";

  // Lưu thông tin khách hàng tạm
  const saveCustomerData = () => {
    localStorage.setItem("lastPayment", JSON.stringify({
      total, name, address, email, phone, note
    }));
  };

  // 6️⃣ Tiền mặt
  cashBtn.onclick = () => {
    saveCustomerData();
    alert(`Đặt hàng thành công!\n\nKhách hàng: ${name}\nĐịa chỉ: ${address}\nEmail: ${email}\nSĐT: ${phone}\nGhi chú: ${note}\nTổng: ${total.toLocaleString()}₫\nHình thức: Tiền mặt`);
    localStorage.removeItem("cart");
    window.location.href = "index.html";
  };

  // 7️⃣ Chuyển khoản (hiển thị ảnh QR thay vì tạo mã)
  bankBtn.onclick = () => {
    saveCustomerData();

    const amount = total;

    qrContainer.style.display = "block";
    paymentMethodDiv.style.display = "none";

    // Hiển thị thông tin và ảnh QR
    qrContainer.innerHTML = `
      <p id="qr-info">Quét mã để thanh toán đúng số tiền: ${amount.toLocaleString()}₫</p>
      <img src="images/anhqr.png" alt="QR thanh toán" style="width:220px;height:220px;border-radius:10px;box-shadow:0 4px 10px rgba(0,0,0,0.1);margin-top:10px;">
      <button id="confirm-payment" class="method-btn" style="margin-top:15px;">Đã thanh toán</button>
    `;

    document.getElementById("confirm-payment").onclick = () => {
      alert(`Thanh toán chuyển khoản thành công!\nTổng: ${amount.toLocaleString()}₫\nKhách hàng: ${name}`);
      localStorage.removeItem("cart");
      window.location.href = "index.html";
    };
  };
});
</script>




  <!-- Footer -->
 <footer class="footer">
  <div class="footer-container">
    
    <!-- Cột 1: Thông tin công ty -->
    <div class="footer-col">
      <h3>CÔNG TY TNHH FITZY</h3>
      <p><strong>Địa chỉ:</strong> 33 Đường 14, KDC Bình Hưng, Ấp 2, Huyện Bình Chánh, TPHCM</p>
      <p><strong>Điện thoại:</strong> (+84) 932 788 120 [hotline]</p>
      <p><strong>Email:</strong> info@fitfood.vn <br> For business inquiries: business@fitfood.vn</p>
      <p><strong>MST:</strong> 0313272749 do Sở Kế hoạch và Đầu tư TPHCM cấp ngày 26/05/2015</p>
    </div>

    <!-- Cột 2: Điều khoản -->
    <div class="footer-col">
      <h3>ĐIỀU KHOẢN CHUNG</h3>
      <ul>
        <li><a href="#">Chính Sách Quy Định Chung</a></li>
        <li><a href="#">Quy Định Hình Thức Thanh Toán</a></li>
        <li><a href="#">Chính Sách Vận Chuyển Giao Hàng</a></li>
        <li><a href="#">Chính Sách Bảo Mật Thông Tin</a></li>
      </ul>
    </div>

    <!-- Cột 3: Mạng xã hội -->
    <div class="footer-col">
      <h3>THEO DÕI CHÚNG TÔI TẠI</h3>
      <div class="socials">
        <a href="https://www.facebook.com/share/17VrRNrhgK/?mibextid=wwXIfr"><i class="fab fa-facebook"></i></a>
        <a href="#"><i class="fab fa-instagram"></i></a>
        <a href="#"><i class="fab fa-youtube"></i></a>
      </div>
      <img src="images/bct.png" alt="Đã thông báo Bộ Công Thương" class="gov-badge">
    </div>
  </div>

  <!-- Thanh tìm kiếm -->
  <div class="footer-search">
    <input type="text" placeholder="Tìm kiếm">
    <button><i class="fas fa-search"></i></button>
  </div>
</footer>
<!-- Nút nổi tin nhắn -->
<div class="chat-widget">
  <div class="chat-toggle">
    <i class="fas fa-comments"></i>
  </div>
  <div class="chat-options">
    <a href="https://m.me/fitfood" target="_blank" class="chat-btn messenger">
      <i class="fab fa-facebook-messenger"></i> Messenger
    </a>
    <a href="https://zalo.me/0815215375" target="_blank" class="chat-btn zalo">
      <img src="icons/zalo.png" alt="Zalo Icon"> Zalo
    </a>
  </div>
</div>


<script>
const toggle = document.querySelector(".chat-toggle");
const options = document.querySelector(".chat-options");

toggle.addEventListener("click", () => {
  const isVisible = options.style.display === "flex";
  options.style.display = isVisible ? "none" : "flex";
});
</script>

  <script src="script.js"></script>
  <script src="cart.js"></script>
  <script src="checkout.js"></script>
</body>
</html>
